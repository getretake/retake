---
title: Hybrid Search
---

ParadeDB's full text and similarity search APIs can be combined in the same query to execute [hybrid search](/api-reference/concepts/search#hybrid-search).

<Note>
This guide uses the [`mock_items` table](/api-reference/introduction#get-started). It assumes that the entire 
[quickstart](/welcome/quickstart) tutorial has been completed, including the vector search section.
</Note>

## Basic Usage

In this guide, we will implement a hybrid search algorithm commonly known as reciprocal rank fusion. This algorithm:

1. Calculates a BM25 and similarity score for the top `n` documents.
2. Ranks documents by their BM25 and similarity scores separately. The highest-ranked document for each score receives an `r` of `1`.
3. Calculates a reciprocal rank for each score as `1/(k + r)`, where `k` is a constant. `k` is usually set to `60`.
4. Calculates each document's reciprocal rank fusion score as the sum of the BM25 and similarity reciprocal rank scores.

To implement this in SQL, we can write the following query:

```sql
WITH semantic_search AS (
    SELECT id, RANK () OVER (ORDER BY embedding <=> %(embedding)s) AS rank
    FROM documents
    ORDER BY embedding <=> %(embedding)s
    LIMIT 20
),
keyword_search AS (
    SELECT id, RANK () OVER (ORDER BY ts_rank_cd(to_tsvector('english', content), query) DESC)
    FROM documents, plainto_tsquery('english', %(query)s) query
    WHERE to_tsvector('english', content) @@ query
    ORDER BY ts_rank_cd(to_tsvector('english', content), query) DESC
    LIMIT 20
)
SELECT
    COALESCE(semantic_search.id, keyword_search.id) AS id,
    COALESCE(1.0 / (%(k)s + semantic_search.rank), 0.0) +
    COALESCE(1.0 / (%(k)s + keyword_search.rank), 0.0) AS score
FROM semantic_search
FULL OUTER JOIN keyword_search ON semantic_search.id = keyword_search.id
ORDER BY score DESC
LIMIT 5
```